{% extends 'layout/admin/base.html' %}
{% from 'macros/misc.html' import render_notification %}
{% set current_page = 'shop_email_admin' %}
{% set current_page_brand = brand %}
{% set current_page_shop = shop %}
{% set page_title = _('Email') %}
{% set layout_main_raw = True %}

{% block head %}
<style>
  .email-example summary:focus {
    outline: none;
  }

  .email-example summary:hover {
    cursor: pointer;
    text-decoration: underline;
  }

  .email-example code {
    background-color: #eeeeee;
    display: block;
    font-size: 0.75rem;
    max-width: 46rem;
    overflow-x: scroll;
    padding: 1rem;
  }
</style>
{%- endblock %}

{% block body %}

  <h1>{{ _('Email') }}</h1>

  <h2>{{ _('Examples') }}</h2>

  <div class="box">

    <details class="email-example">
      <summary>{{ _('Order confirmation') }}</summary>
      {{ render_message_text(placed_order_message_text) }}
    </details>

    <details class="email-example">
      <summary>{{ _('Payment receipt') }}</summary>
      {{ render_message_text(paid_order_message_text) }}
    </details>

    <details class="email-example">
      <summary>{{ _('Cancelation') }}</summary>
      {{ render_message_text(canceled_order_message_text) }}
    </details>

  </div>

  <h2>{{ _('Configuration') }}</h2>
  <div class="box">
    <table class="index">
      <tr>
        <th>{{ _('Sender address') }}</th>
        <td>{{ email_config.sender.address }}</td>
      </tr>
      <tr>
        <th>{{ _('Sender name') }}</th>
        <td>{{ email_config.sender.name|fallback }}</td>
      </tr>
      <tr>
        <th>{{ _('Contact address') }}</th>
        <td>{{ email_config.contact_address|fallback }}</td>
      </tr>
    </table>
  </div>

{%- endblock %}

{% macro render_message_text(message_text) -%}
  {%- if message_text -%}
    <pre><code>{{ message_text }}</code></pre>
  {%- else -%}
    {{ render_notification('Could not assemble example email. Are all necessary templates defined?', category='danger') }}
  {%- endif -%}
{%- endmacro %}
