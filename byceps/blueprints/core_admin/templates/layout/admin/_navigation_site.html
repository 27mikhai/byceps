{%- from 'macros/admin.html' import render_navigation %}


{%- if site %}
<section class="sidebar-section">
  <header class="sidebar-section-header">
    <div class="sidebar-section-category">Site</div>
    <div class="dropdown">
      <button class="dropdown-toggle button button--clear button--compact sidebar-section-title">
        <span>{{ site.title }}</span> {{ render_icon('caret-down') }}
      </button>
      <ol>
        {%- for site in get_sites_for_party(party.id)|sort(attribute='title') %}
        <li><a href="{{ url_for('site_admin.view', site_id=site.id) }}">{{ site.title }}</a></li>
        {%- endfor %}
      </ol>
    </div>
  </header>
  {%- set navigation = Navigation('Site')
      .add_item(url_for('site_admin.index', party_id=party.id), 'Einstellungen', id='site_admin', required_permission=SitePermission.view, icon='site')
      .add_item(url_for('snippet_admin.index_for_scope', scope_type='site', scope_name=site.id), 'Snippets', id='snippet_admin', required_permission=SnippetPermission.view, icon='snippet')
  -%}
{{ render_navigation(navigation, current_page) }}
</section>
{%- elif party %}
<section class="sidebar-section">
  <header class="sidebar-section-header">
    <div class="sidebar-section-title">Sites</div>
  </header>
  <nav class="main">
  {%- with party_sites = get_sites_for_party(party.id) %}
    {%- if party_sites %}
    <ol>
      {%- for site in party_sites|sort(attribute='title') %}
      <li>
        <a href="{{ url_for('site_admin.view', site_id=site.id) }}" class="nav-item">
          <span class="nav-item-label">{{ site.title }}</span>
        </a>
      </li>
      {%- endfor %}
    </ol>
    {%- else %}
    <p>{{ 'keine'|dim }}</p>
    {%- endif %}
  {%- endwith %}
  </nav>
</section>
{%- endif %}
